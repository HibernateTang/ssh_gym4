<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" type="text/css" href="./css/weui.min.css">
    <link rel="stylesheet" type="text/css" href="./css/swiper-3.4.2.min.css">
    <script src="./js/jquery-1.11.3.min.js"></script>
    <script src="./js/swiper-3.4.2.jquery.min.js"></script>
    <script src="./js/fastclick.js"></script>
    <title>手机会员登录</title>
    <script>
        $(function () {
            FastClick.attach(document.body);
        });
        $(document).ready(function () {
            var mySwiper = new Swiper('.swiper-container', {
                effect: 'flip',
            })

            $('#toSignUp').on('click', function () {
                mySwiper.slideNext()
            });
            
            $('#signIn').on('click',function () {
                var username = $("#login_tel").val();
                var password = $("#login_pass").val();
                login_ajax(username,password);
            })

            $('#signUp').on('click',function(){
                var username = $('#reg_tel').val();
                var password = $('#reg_pass').val();
                regsister_ajax(username,password);
            })
        })
        
        
        function login_ajax(telephone, password) {
            this.username = telephone;
//            this.password = hex_md5(password);
            this.password = password;
            $.ajax({
                type:"POST",
                url:"/login/tologin",
                data:{"username":this.username,"password":this.password},
                contentType:"application/x-www-form-urlencoded",
                dataType:"json",
                success:function(data){
                    console.log(data);
                        if(data.success == true && data.message == "登录成功"){
                            alert("登录成功1!");

                            window.location.href="/index";
//                            window.location.href = "../jsp/infojsp/info.jsp?userName="+data.value.username+
//                                    "&userId="+data.value.id;
                        }else if(data.success == false && data.message == "密码错误"){
                            alert("密码错误!");
                        }else if(data.success == false && data.message == "该用户不存在!"){
                            alert("该用户不存在!");
                        }
                }
            });
        }

        function regsister_ajax(username,password){
            this.username = username;
            this.password = password;
            $.ajax({
                type:"POST",
                url:"/login/register",
                data:{"username":this.username,"password":this.password},
                contentType:"application/x-www-form-urlencoded",
                dataType:"json",
                success:function(data){
                    console.log(data);
                    if(data.success == true && data.message == "注册成功"){
                        alert("注册成功!");
//                        window.location.href = "login_old.html";
                          mySwiper.slidePrev()
                    }else if(data.success == false && data.message == "该用户名已存在..."){
                        alert("该用户名已被注册...");
                    }
                }
            });
        }
    </script>
    <style>
        .user-actor {
            text-align: center;
        }

        .user-actor img {
            width: 8rem;;
            height: 8rem;
            margin-top: 1rem;
            border-radius: 4rem;
        }

        .user-welcome {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            font-family: Microsoft YaHei;
            font-weight: bold;
            text-align: center;
        }

    </style>

</head>
<body>
<div class="swiper-container">
    <div class="swiper-wrapper">
        <div class="swiper-slide sign-in">
            <div class="weui-flex">
                <div class="weui-flex__item user-actor">
                    <img src="./images/signin/actor.jpg"/>
                </div>
            </div>

            <div class="user-welcome"><h1>Hello，小小运动馆</h1></div>
            <div class="weui-cell">
                <div class="weui-cell__hd">
                    <label class="weui-label">手机号</label>
                </div>
                <div class="weui-cell__bd">
                    <input class="weui-input" id="login_tel" type="tel" value="admin" placeholder="请输入手机号">
                </div>
                <!--<div class="weui-cell__ft">-->
                <!--<button class="weui-vcode-btn">获取验证码</button>-->
                <!--</div>-->
            </div>
            <div class="weui-cell">
                <div class="weui-cell__hd"><label class="weui-label">密码</label></div>
                <div class="weui-cell__bd">
                    <input class="weui-input" type="password" value="admin" id="login_pass"  pattern="[a-z]*" placeholder="请输入密码">
                </div>
            </div>
            <div class="weui-btn-area">
                <a href="javascript:;" class="weui-btn weui-btn_primary" id="signIn">登录</a>
                <a href="javascript:;" class="weui-btn weui-btn_plain-primary" id="toSignUp">没有帐号？点击注册</a>
            </div>
        </div>

        <div class="swiper-slide sign-up">
            <div class="weui-flex">
                <div class="weui-flex__item user-actor">
                    <img src="./images/signin/actor.jpg"/>
                </div>
            </div>

            <div class="user-welcome"><h1>Hello，小小运动馆</h1></div>
            <div class="weui-cell weui-cell_vcode">
                <div class="weui-cell__hd">
                    <label class="weui-label">手机号</label>
                </div>
                <div class="weui-cell__bd">
                    <input class="weui-input" type="tel" id="reg_tel" placeholder="请输入手机号">
                </div>
                <div class="weui-cell__ft">
                    <button class="weui-vcode-btn">获取验证码</button>
                </div>
            </div>
            <div class="weui-cell">
                <div class="weui-cell__hd"><label class="weui-label">密码</label></div>
                <div class="weui-cell__bd">
                    <input class="weui-input" type="password" id="reg_pass"  pattern="[a-z]*" placeholder="请输入密码">
                </div>
            </div>
            <div class="weui-cell">
                <div class="weui-cell__hd"><label class="weui-label">验证码</label></div>
                <div class="weui-cell__bd">
                    <input class="weui-input" type="number" pattern="[0-9]*" placeholder="请输入验证码">
                </div>
            </div>
            <div class="weui-btn-area">
                <a href="javascript:;" class="weui-btn weui-btn_primary" id="signUp">申请</a>
            </div>
        </div>
    </div>
</div>

<script>

</script>
</body>
</html>